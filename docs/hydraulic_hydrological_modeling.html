<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.267">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="This text is intended for the modern study of hydrology and mathematical modeling of hydrological systems in semi-arid Central Asia. It is geared towards students and teachers that would like to learn about these topics in an applied manner. The book adopts an open-educational philosophy and promotes the use of open data and free of charge software. This is the 2022 release of the book.">
<title>Modeling of Hydrological Systems in Semi-Arid Central Asia - 8&nbsp; Hydrological-Hydraulic Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><link href="./long_term_water_balance_modeling.html" rel="next">
<link href="./hydrological_modeling.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hydrological-Hydraulic Modeling</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modeling of Hydrological Systems in Semi-Arid Central Asia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hydrosolutions/caham_book" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study_guide_materials.html" class="sidebar-item-text sidebar-link">Study Guide and Materials</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./hydrology_of_central_asia.html" class="sidebar-item-text sidebar-link">Part I: Hydrology of Semi-Arid Central Asia</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hydrological_systems.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Hydrological Systems in Semi-Arid Central Asia</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example_river_basins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Case Study River Basins</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./data.html" class="sidebar-item-text sidebar-link">Part II: Data Sources, Retrieval and Preparation</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_sources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sources of Relevant Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discharge_station_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Discharge Station Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geospatial_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Geospatial Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snow_and_glacier_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Snow and Glacier Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./climate_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Climate Data</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./hydrological_modeling.html" class="sidebar-item-text sidebar-link">Part III: Hydrological Modeling &amp; Applications</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hydraulic_hydrological_modeling.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hydrological-Hydraulic Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./long_term_water_balance_modeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Long-term Water Balance Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeling_using_predictive_inference.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modeling Using Predictive Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glacier_modeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling of Discharge from Glacier Melt</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./real_world_examples.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Real World Hydrological Model Applications</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_a_free_software.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Software</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_b_riverscentralasia_r_toolbox.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">R Toolbox riversCentralAsia</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_c_quick_guides.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Quick Guides</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_d_exercise_solutions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Exercise Solutions</span></a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#section-rsminerve-prerequisites" id="toc-section-rsminerve-prerequisites" class="nav-link active" data-scroll-target="#section-rsminerve-prerequisites"> <span class="header-section-number">8.1</span> Prerequisites</a></li>
  <li><a href="#section-general-modelling-process" id="toc-section-general-modelling-process" class="nav-link" data-scroll-target="#section-general-modelling-process"> <span class="header-section-number">8.2</span> The general modeling process</a></li>
  <li><a href="#section-rsminerve-why-model-introduction" id="toc-section-rsminerve-why-model-introduction" class="nav-link" data-scroll-target="#section-rsminerve-why-model-introduction"> <span class="header-section-number">8.3</span> The most simple model - the linear reservoir model</a></li>
  <li><a href="#section-hbv-model" id="toc-section-hbv-model" class="nav-link" data-scroll-target="#section-hbv-model"> <span class="header-section-number">8.4</span> The HBV model</a></li>
  <li>
<a href="#the-rs-minerve-modelling-environment" id="toc-the-rs-minerve-modelling-environment" class="nav-link" data-scroll-target="#the-rs-minerve-modelling-environment"> <span class="header-section-number">8.5</span> The RS Minerve modelling environment</a>
  <ul class="collapse">
<li><a href="#loading-gis-data" id="toc-loading-gis-data" class="nav-link" data-scroll-target="#loading-gis-data"> <span class="header-section-number">8.5.1</span> Loading GIS data</a></li>
  <li><a href="#automatic-model-generation" id="toc-automatic-model-generation" class="nav-link" data-scroll-target="#automatic-model-generation"> <span class="header-section-number">8.5.2</span> Automatic model generation</a></li>
  <li><a href="#loading-climate-data" id="toc-loading-climate-data" class="nav-link" data-scroll-target="#loading-climate-data"> <span class="header-section-number">8.5.3</span> Loading climate data</a></li>
  <li><a href="#configuration" id="toc-configuration" class="nav-link" data-scroll-target="#configuration"> <span class="header-section-number">8.5.4</span> Configuration</a></li>
  <li><a href="#sec-first-rsm-model-run" id="toc-sec-first-rsm-model-run" class="nav-link" data-scroll-target="#sec-first-rsm-model-run"> <span class="header-section-number">8.5.5</span> First model run</a></li>
  </ul>
</li>
  <li><a href="#sec-model-calibration" id="toc-sec-model-calibration" class="nav-link" data-scroll-target="#sec-model-calibration"> <span class="header-section-number">8.6</span> Model calibration</a></li>
  <li><a href="#sec-hydrological-hydraulic-modeling-references" id="toc-sec-hydrological-hydraulic-modeling-references" class="nav-link" data-scroll-target="#sec-hydrological-hydraulic-modeling-references"> <span class="header-section-number">8.7</span> References</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/hydrosolutions/caham_book/edit/master/hydraulic_hydrological_modeling.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-hydraulic-hydrological-modeling" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hydrological-Hydraulic Modeling</span></span></h1>
</div>

<div>
  <div class="description">
    This text is intended for the modern study of hydrology and mathematical modeling of hydrological systems in semi-arid Central Asia. It is geared towards students and teachers that would like to learn about these topics in an applied manner. The book adopts an open-educational philosophy and promotes the use of open data and free of charge software. This is the 2022 release of the book.
  </div>
</div>




<div class="quarto-title-meta">

    
    
  </div>
  

</header><p>Hydrological-hydraulic models are used for different purposes, including for the design of basin plans while taking into consideration different development options, for the study of effective water resources management schemes while taking into consideration the different types of sectoral users and uses of water in a basin (ideally also including minimal environmental flows), and for the detailed study of basin-scale climate impacts and their repercussions.</p>
<p>This Chapter introduces combined hydrologic and hydraulic modeling using the freely available graphical modeling environment RS Minerve [<span class="citation" data-cites="rsminerve_software">CREALP (<a href="#ref-rsminerve_software" role="doc-biblioref">2021</a>)</span>; <span class="citation" data-cites="rsminerve_um">Foehn et al. (<a href="#ref-rsminerve_um" role="doc-biblioref">2020</a>)</span>; <span class="citation" data-cites="rsminerve_tm">Garcia Hernandez et al. (<a href="#ref-rsminerve_tm" role="doc-biblioref">2020</a>)</span>]<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. <a href="#fig-rsminervemodelpreview">Figure&nbsp;<span>8.1</span></a> shows a screen shot of a model of the Gunt river basin setup in RS Minerve as a teaser.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-rsminervemodelpreview" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/hydrological_modeling/rsminerveModelPreview_lr.png" class="img-fluid figure-img" width="1680"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.1: Screenshot of an RS Minerve model setup for Gunt river basin.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>It should be noted that other modeling packages exist for hydrological-hydraulic modeling. Among others, these include</p>
<ul>
<li>
<a href="https://www.weap21.org" target="_blank">WEAP: Water Evaluation and Planning System</a>,</li>
<li>
<a href="https://swat.tamu.edu" target="_blank">SWAT: Soil &amp; Water Assessment Tool</a>, and</li>
<li><a href="https://www.mikepoweredbydhi.com/products/mike-hydro-basin" target="_blank">Mike Hydro Basin</a></li>
</ul>
<p>As some if not most of these modeling packages are license-based, the advantage of using the combination of <a href="https://www.qgis.org/en/site/">QGIS</a>, <a href="https://www.r-project.org">R</a> and <a href="https://www.crealp.ch/fr/accueil/outils-services/logiciels/rs-minerve.html">RS Minerve</a> is that this is a completely free software suit for any user and use scenario.</p>
<p>Departing from catchment GIS data, RS Minerve allows to quickly develop, test and calibrate different types of lumped conceptual precipitation runoff models while taking into account the evolution of water balances in glacier, snow, surface and subsurface compartments over time and in different sections in the catchment under consideration. This is demonstrated here for the Gunt River Basin in the Pamirs (see Chapter @ref(GuntRB) for more information).</p>
<p>The main goal in this Chapter is to familiarize the student on how to setup such model, calibrate and validate it for past and current climate conditions and then to <strong>study climate change impacts in the basin</strong>.</p>
<section id="section-rsminerve-prerequisites" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="section-rsminerve-prerequisites">
<span class="header-section-number">8.1</span> Prerequisites</h2>
<p>Before delving into this section of the course material, you should have at least:</p>
<ul>
<li>RS Minerve installed <a href="#section-quickguides-how-to-download-and-install-rsminerve">How to install RS Minerve</a>. This tutorial was written using RS Minerve 2.9.1.0.</li>
<li>Read chapters 1 and 2 from the RS Minerve user manual <span class="citation" data-cites="rsminerve_um">(<a href="#ref-rsminerve_um" role="doc-biblioref">Foehn et al. 2020</a>)</span> (the manual can be downloaded from the CREALP website, see Section <a href="#section-quickguides-how-to-download-and-install-rsminerve">How to install RS Minerve</a>).<br>
</li>
<li>Familiarize yourself with RS Minerve by following Example 1 in the RS Minerve user manual.<br>
</li>
<li>Read the HBV model description in the RS Minerve technical manual (Chapter 2.7) <span class="citation" data-cites="rsminerve_tm">(<a href="#ref-rsminerve_tm" role="doc-biblioref">Garcia Hernandez et al. 2020</a>)</span>.</li>
</ul>
<p>You may have to dig deeper into the user manual and the technical manual within the frame of the course but the above points are the minimum requirement to get started.<br>
If you fulfill the prerequisites, you should be able to do the tutorial with the minimal description in the modeling section. However, detailed step-by-step descriptions are linked for each task.</p>
</section><section id="section-general-modelling-process" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="section-general-modelling-process">
<span class="header-section-number">8.2</span> The general modeling process</h2>
<p>Hydrological modeling is an iterative process (see <a href="#fig-iterative-modelling-process">Figure&nbsp;<span>8.2</span></a>). At the beginning, the purpose of the model has to be defined. The model goal determines the spatial and temporal resolution of the hydrological model. E.g. for analyzing the impact of climate change on seasonal, regional flows we are interested in the seasonal flow volumes whereas a model used for early warnings from floods requires high temporal resolution and a high model performance for threshold overflows. See for example <span class="citation" data-cites="bloschl_scale_1995">Blöschl and Sivapalan (<a href="#ref-bloschl_scale_1995" role="doc-biblioref">1995</a>)</span> for a thorough discussion of scales in hydrological modeling. Please note that the definition of the model goal also determines the performance criteria the model has to fulfill in order to be judged suitable for its purpose. As a next step, data about the catchment is gathered (see for example basin characterization in the Chapter <a href="#CaseStudies">Case Studies</a>) and a first conceptual model of the dominant flow processes in the basin is drafted (e.g.&nbsp;low peaks and significant base flow point to large storage capacity in the basin whereas high peaks and low base flow indicate small storage capacity in the basin). The conceptual model of the river catchment is then implemented with a mathematical model (e.g.&nbsp;the HBV model in RS Minerve) and parameterized as well as possible (i.e.&nbsp;using reasonable estimates for initial parameter values). The model is then calibrated and validated (i.e.&nbsp;tested with a previously unseen data set) as described further below If the performance criteria for the model calibration are satisfied, a conscientious modeler performs a sensitivity analysis to gain confidence in the model. From each of these steps, the modeler can (and generally has to) go back to a previous step to gather more data, modify the conceptual model, adapt the model implementation, re-calibrate the model and/or re-evaluate the model sensitivity. Also, the modeler is aware of the inherent uncertainties of the data and the model (see for example <span class="citation" data-cites="refsgaard_uncertainty_2007">Refsgaard et al. (<a href="#ref-refsgaard_uncertainty_2007" role="doc-biblioref">2007</a>)</span> for a discussion on how to include uncertainties in the modeling process). The described steps produce a model (or an ensemble of models) that satisfy the performance criteria, only now the modeler can start actually using the model for the purpose it was implemented for.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-iterative-modelling-process" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/hydrological_modeling/fig_modelling_process.png" class="img-fluid figure-img" width="818"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.2: The modelling process is iterative.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Modeling is an involved process requiring highly specialized knowledge and skills. A modeler has the responsibility to clearly state the underlying assumptions, uncertainties and limitations of their model, especially if it is to be used in decision making. This book chapter will guide you through the modeling process with the example of the Nauvalisoy catchment.</p>
</section><section id="section-rsminerve-why-model-introduction" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="section-rsminerve-why-model-introduction">
<span class="header-section-number">8.3</span> The most simple model - the linear reservoir model</h2>
<p>Why do we do hydrological modeling? Typically we want to know how much river flow we can expect at a given time in the future so we can plan our water consumption ahead, harness against floods or implement measures against droughts. So how can we forecast river discharge? For example, one could use the long term seasonal average discharge as the likely future discharge. However, in some years we have high discharge and in some years we have low discharge (<a href="#fig-discharge-nauvalisoy">Figure&nbsp;<span>8.3</span></a>). How to tell when you have which discharge?</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-discharge-nauvalisoy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="hydraulic_hydrological_modeling_files/figure-html/fig-discharge-nauvalisoy-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.3: Seasonal discharge of the Nauvalisoy river illustrating the variability of the discharge.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Let’s go back to the water balance: Where does the water in the river come from? Precipitation. When we compare precipitation and discharge time series we see that the two are related (<a href="#fig-precipitation-nauvalisoy">Figure&nbsp;<span>8.4</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-precipitation-nauvalisoy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="hydraulic_hydrological_modeling_files/figure-html/fig-precipitation-nauvalisoy-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.4: Discharge (red) and precipitation (grey) in the Nauvalisoy catchment.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Higher precipitation in the catchment is positively correlated with higher discharge in the river with a delay. Or in other words: The discharge is the catchments hydrological response to precipitation. The relationship is can be expressed as follows:</p>
<p><span class="math display">\[
Q \propto P \cdot K
\]</span></p>
<p>In words this reads: Discharge (Q) is proportional to precipitation (P) times a transfer function (K) that defines the delay of the signal. The transfer function K describes how precipitation becomes river discharge and depends on the catchment characteristics, importantly on the storage capacity of the catchment. In reality, the transformation of precipitation to discharge is quite complex but we can simplify the reality and come up with a basic conceptual model of our river catchment: a large bath tube with the area of the catchment and an outlet at the bottom called the <em>linear reservoir model</em> (<a href="#fig-from-catchment-to-bucket">Figure&nbsp;<span>8.5</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-from-catchment-to-bucket" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/fig_fromCatchmentToBucket.png" class="img-fluid figure-img" width="809"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.5: From the real-life system (left) to a linear reservoir (right).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The linear reservoir model describes the discharge from the reservoir as linearly proportional to the storage in the reservoir:</p>
<p><span class="math display">\[
Q(t) = 1/k \cdot S(t)
\]</span></p>
<p>Where Q is discharge, S is the storage and k is a constant called storage coefficient depending on the storage capacity of the reservoir. If k is small, the stored water will run out quickly, if k is large, the stored water will run out slowly. (t) indicate time dependent variables, i.e.&nbsp;variables that change over time.<br>
Substitute the linear reservoir equation into the water balance:</p>
<p><span class="math display">\[
P = Q + dS/dt \Leftrightarrow P = Q + k \cdot dQ/dt
\]</span></p>
<p>Where P is the <em>excess</em> precipitation, i.e.&nbsp;the precipitation that is not intercepted by plants or ponds but contributes to discharge. The above is a differential equation and can be re-arranged:</p>
<p><span class="math display">\[(P-Q) \cdot dt = k \cdot dQ\]</span></p>
<p>and integrated and solved for Q(t) (dig out your mathematics!). In the example in the box below we discretized the water balance with the linear relationship between discharge and storage change in the reservoir:</p>
<p><span class="math display">\[\frac{P_{t_1}+P_{t_1}}{2} - \frac{Q_{t1}+Q_{t_2}}{2} = \frac{k}{t_2-t_1} \cdot (Q_{t_2}-Q_{t_1})\]</span></p>
<p>and solved the equation for <span class="math inline">\(Q_{t_2}\)</span> (Inspiration from <span class="citation" data-cites="Pedersen1980">Pedersen, Peters, and Helweg (<a href="#ref-Pedersen1980" role="doc-biblioref">1980</a>)</span>).<br>
We assume that at the beginning of our experiment, we don’t have a discharge as the bucket is empty.</p>
<p><span class="math display">\[Q(t) = P(t) \cdot (1-e^{(-t/k)})\]</span></p>
<p>This is the equation for the rising discharge curve. Once you turn off the recharge of the reservoir (once you stop pouring water into the bucket), the discharge from the bucket can be described as:</p>
<p><span class="math display">\[Q(t) = Q^* \cdot e^{-\tau/k}\]</span></p>
<p>Which describes the receding limb of the hydrograph (<a href="#section-quickguides-what-is-a-hydrograph">What is a hydrograph</a>) with <span class="math inline">\(\tau\)</span> being the time since the recharge stopped.</p>
<p>Understanding the linear reservoir model is the first steping stone to hydrological modeling as many concenptual models build up on linear reservoirs.</p>
</section><section id="section-hbv-model" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="section-hbv-model">
<span class="header-section-number">8.4</span> The HBV model</h2>
<p>The HBV (Hydrologiska Byråns Vattenavdelning) model is a conceptual rainfall-runoff model which is suitable for many snow-fed river catchments <span class="citation" data-cites="bergstrom_development_1976 lindstrom_development_1997">(<a href="#ref-bergstrom_development_1976" role="doc-biblioref">Bergström 1980</a>; <a href="#ref-lindstrom_development_1997" role="doc-biblioref">Lindström et al. 1997</a>)</span>. We recommend you to study the short description of the HBV model in the RS Minerve technical manual <span class="citation" data-cites="rsminerve_tm">(<a href="#ref-rsminerve_tm" role="doc-biblioref">Garcia Hernandez et al. 2020</a>)</span>. Keep these 4 pages at hand for the following exercises so you can look up how the parameters influence the flow of water through the HBV model. A brief reminder of the HBV model implemented in RS Minerve is given in <a href="#fig-overview-hbv-model">Figure&nbsp;<span>8.6</span></a>.<br>
In RS Minerve, the catchment area is typically sub-divided into areas with similar hydrological properties, so called hydrological response units or HRUs, for which the discharge is computed individually. Several HRUs can be connected. This approach is often numerically more efficient than a gridded discretization of the catchment area.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-overview-hbv-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/fig_HBVconceptualModel.png" class="img-fluid figure-img" width="437"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.6: The HBV model concept (source: RS MINERVE Technical Manual).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Water enters the HBV model in the form of precipitation <span class="math inline">\(P\)</span>, which is a model forcing provided by the user. Precipitation is separated into solid (snow fall <span class="math inline">\(SF\)</span>) and liquid (rainfall <span class="math inline">\(RF\)</span>) depending on the termperature <span class="math inline">\(T\)</span>, the second model forcing provided by the user. The uppermost component of the HBV model is the snow model (the two top-most blue reservoirs in <a href="#fig-overview-hbv-model">Figure&nbsp;<span>8.6</span></a>). A degree-day-melt model melts snow and refreezes water (<span class="math inline">\(M_{sn}\)</span>).<br>
The rainfall plus the snow melt are accumulated to the precipitation equivalent <span class="math inline">\(P_{eq}\)</span> which enters the uppermost soil layer represented in HBV by the soil humidity reservoir of the root zone. This non-linear reservoir represents the loss of water to direct evaporation and to plant evaporation. Potential evaporation <span class="math inline">\(ETP\)</span> thereby is another model forcing, albeit optional, as it can be provided by the user or calculated based on temperature and latitude by RS Minerve.<br>
Water that is not evaporated or held in the root zone is recharged to deeper soil layers, the upper reservoir. The upper reservoir constitutes the unsaturated zone below the root zone and produces the direct runoff or near-surface runoff (<span class="math inline">\(Q_r\)</span>) that occurs when the soils are saturated and the interflow (<span class="math inline">\(Q_u\)</span>) which is a lateral discharge in the unsaturated zone.<br>
Through deep percolation (<span class="math inline">\(i_{Perc}\)</span>) water reaches the lower reservoir which corresponds to the saturated zone, the groundwater layer, and produces the baseflow or the lateral discharge of groundwater (<span class="math inline">\(Q_l\)</span>). By the way, the lower reservoir is very similar to the linear reservoir discussed above with the exception of an upper storage limit (<span class="math inline">\(SL\)</span>).</p>
<p>The several reservoirs of the HBV model come with a multitude of parameters (<a href="#fig-overview-hbv-model-parameters">Figure&nbsp;<span>8.7</span></a>) which have to be adjusted such that the model reproduces the measured discharge of the basin, a process called model calibration which will be discussed in more detail further on in this chapter. Here we’d like you to note the number of model states and parameters or degrees of freedom the HBV model has and to compare it to the amount of measurements of model states that is actually available to constrain the model parameters.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-overview-hbv-model-parameters" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/fig_PARandIC.png" class="img-fluid figure-img" width="796"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.7: The HBV model parameters (source RS MINERVE Technical Manual).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In the HBV model, 6 parameters need to be constrained alone for the snow model (<a href="#fig-overview-hbv-model-parameters">Figure&nbsp;<span>8.7</span></a>). Typically, measurements of the states of the model reservoirs (<span class="math inline">\(SWE\)</span> and <span class="math inline">\(WH\)</span>, <span class="math inline">\(Hum\)</span>, <span class="math inline">\(SU\)</span>, <span class="math inline">\(SL\)</span>) are not available. Thus, more often than not, parameters of hydrological models are solely calibrated based on the aggregated total discharge of a basin. A lot of care should be given to trying to constrain the model parameters using combinations of different approaches:</p>
<ul>
<li>Minimize the number of parameters in your model<br>
This is done by fixing the least sensitive parameters to literature values</li>
<li>Compare to parameter values from the literature for similar catchments</li>
<li>Look for data sets that may be used to calibrate parts of the model</li>
<li>Do not only minimize the error between the measured and the simulated discharge but look at all the models states and fluxes and make sure they are physically meaningful</li>
</ul>
<p>Luckily, research into suitable data products to further constrain hydrological models.</p>
<p>The simulated snow water equivalent may be compared to the snow water equivalend available from the High Mountain Asia Snow Reanalysis product so one variable can be used to . Water storage in the root zone, the soil or in the lower reservoirs are generally not available thus the</p>
</section><section id="the-rs-minerve-modelling-environment" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="the-rs-minerve-modelling-environment">
<span class="header-section-number">8.5</span> The RS Minerve modelling environment</h2>
<p>The reader should already be familiar with RS Minerve through completion of example 1 in the RS Minerve user guide. The following paragraphs demonstrate how to automatically implement a hydrological model in RS Minerve using an example basin from Central Asia. The basin of the river Chon Kemin hereby serves as a demonstration site.</p>
<section id="loading-gis-data" class="level3" data-number="8.5.1"><h3 data-number="8.5.1" class="anchored" data-anchor-id="loading-gis-data">
<span class="header-section-number">8.5.1</span> Loading GIS data</h3>
<p>Open RS Minerve and move to the GIS tab (1). Click on the Add Layers button in the top right corner of the menu bar (2). An explorer window will pop-up where you select the layers you want to load (3). You require the HRU, junction and river layers which have been prepared for you in the student case study pack.</p>
<p><img src="images/hydrological_modeling/rsm_loadGISdata_01.png" id="fig-rsm-load-gis-data-01" class="img-fluid" alt="Loading GIS data in RS Minerve."> Click Open (4) to close the explorer window and to load the selected GIS layers into RS Minerve. The result is shown in <a href="#fig-rsm-load-gis-data-02">Figure&nbsp;<span>8.8</span></a>.</p>
<div id="fig-rsm-load-gis-data-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadGISdata_02.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.8: GIS data loaded in RS Minerve</figcaption><p></p>
</figure>
</div>
<p>RS Minerve offers limited GIS utilities. You can, for example, change the colors of the GIS layers in the layer properties. The usage is similar to QGIS. You can further inspect the layer attributes by selecting a layer (1) and clicking the Table Info button (2) to open the attribute table.</p>
<div id="fig-rsm-load-gis-data-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadGISdata_03.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.9: View the attribute table of an example layer in RS Minerve.</figcaption><p></p>
</figure>
</div>
</section><section id="automatic-model-generation" class="level3" data-number="8.5.2"><h3 data-number="8.5.2" class="anchored" data-anchor-id="automatic-model-generation">
<span class="header-section-number">8.5.2</span> Automatic model generation</h3>
<p>To automatically generate the model structure, make sure, the 3 required GIS layers are loaded (section above), then click on the Creation button in the Model Management toolbox (1). The model creation configuration window will pop up where you select the appropriate attributes for each model layer from the drop-down menus (2, 4). Tick the Altitude (Z) option in the Subbasins properties and select the Z attribute (3) to let RS Minerve know the altitude of each HRU.</p>
<div id="fig-rsm-auto-model-creation-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_01.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.10: Configuration of the model creation utilities. Selecting the appropriate attributes from the GIS layers.</figcaption><p></p>
</figure>
</div>
<p>Then select all sub-basins in the Allocate SubBasins Type window (5) and click on the model object selector (6).</p>
<p>Select the HBV model (1) and click the Allocate Subbasins button (2).</p>
<div id="fig-rsm-auto-model-creation-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_02.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.11: Configuration of the model creation utilities. Selecting hydrological models for each HRU.</figcaption><p></p>
</figure>
</div>
<p>All the sub-basins should now display the red HBV icon as shown in <a href="#fig-rsm-auto-model-creation-03">Figure&nbsp;<span>8.12</span></a>. Next, select the river stretch ChonKemin (1), select the Kinematic Wave in the drop-down menu (2) and press Allocate Rivers (3). The icon of the rivers sections should subsequently be colored in the Kindematic Wave colours (not shown).</p>
<div id="fig-rsm-auto-model-creation-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_03.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.12: Configuration of the model creation utilities. Selecting hydrodynamic stream flow models for each river section.</figcaption><p></p>
</figure>
</div>
<p>Finally, press the Create Model button in the lower right corner of the RS Minerve window (4). If the model creation process is successful, the message <strong><em>Creation model finished.</em></strong> appears in the lower left corner of the RS Minerve window (5). If the model creation process is not successful, an error message will appear instead at the same location which will support you in identifying the problem.</p>
<p>You can now switch to the Model tab and look at the automatically generated model layout (<a href="#fig-rsm-auto-model-creation-04">Figure&nbsp;<span>8.13</span></a>).</p>
<div id="fig-rsm-auto-model-creation-04" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_04.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.13: Automatically generated model layout of the Chon Kemin catchment.</figcaption><p></p>
</figure>
</div>
<p>The river stretch is no longer required. Delete it by selecting it with a left-click on the river object and then pressing delete in the Editing Tools menu in the header bar.</p>
<p>You can beautify the model view by loading a background image of the Chon Kemin catchment (for example a screen shot from QGIS, <a href="#fig-rsm-auto-model-creation-05">Figure&nbsp;<span>8.14</span></a>) and by re-arranging the HRUs (click and drag) and climate stations for better readability.</p>
<div id="fig-rsm-auto-model-creation-05" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_05.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.14: Load a background image into RS Minerve by clicking Background (1) Load (2) , selecting the image (3) and pressing Open (4). Exit the background image editing mode by clicking (1) again.</figcaption><p></p>
</figure>
</div>
<p>Now we need to add a comparator and a source object in order to be able to compare the simulated river discharge to the observed discharge. Step-by-step you need to click on the Source object in the model object list (1). A small faucet icon will appear en lieu of your customary cursor icon. Move your cursor to an appropriate location in the map window and click to place the source object (2). Do the same for the comparator object: activate it by clicking the object (3) and place it with a click in the map window (4).</p>
<div id="fig-rsm-auto-model-creation-06" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_06.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.15: Adding source and comparator object to the model layout.</figcaption><p></p>
</figure>
</div>
<p>The new objects now need to be connected to the rest of the model objects. Activate the Connections mode in the Editing tools box of the header bar (5). Then draw a line from the source object to the comparator object (6). In the pop-up window, specify that the source object is your reference (7). Then accknowledge by clicking Ok.</p>
<p>In the same manner, draw a connection from the junction object (15149_gauge) to the comparator (1) and specify that the junction represents your simulated discharge (2).</p>
<div id="fig-rsm-auto-model-creation-07" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_autoModelCreation_07.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.16: Connecting the new objects to the rest of the model objects.</figcaption><p></p>
</figure>
</div>
<p>Deactivate the connection mode by clicking the Select button (3). You can re-name the new objects by clicking on their names. The basic model layout is now finished but there are still a few required steps before we can run the model.</p>
<p>With the present model we can now simulate discharge from rainfall and snow melt. We can further simulate the evolution of the water storage in different compartments in the catchments. What about glacier melt? Glacier melt can be simulated in RS Minerve with the GSM model. However, the GSM model is only marginally suitable for long-term scenario simulation. We therefore suggest a different glacier modeling strategy where discharge from glacier melt is simulated externally and then included into RS Minerve as a source. The process is described in Chapter <a href="glacier_modeling.html">Section&nbsp;<span>11</span></a>.</p>
</section><section id="loading-climate-data" class="level3" data-number="8.5.3"><h3 data-number="8.5.3" class="anchored" data-anchor-id="loading-climate-data">
<span class="header-section-number">8.5.3</span> Loading climate data</h3>
<p>The hydrological model needs forcing data: Precipitation and Temperature. The following sections illustrate how to load the pre-processed climate data into RS Minerve.</p>
<p>Navigate to the Database tab (1) and click the Open button (2). This opens an explorer pop-up window where you choose csv files in the drop-down menu (3) and then select the file hist_obs_rsm.csv. Close the explorer window by pressing the Open button (hidden beneath the drop-down menu in <span class="quarto-unresolved-ref">?fig-rsm-load-db-01</span>).</p>
<p><img src="images/hydrological_modeling/rsm_loadDatabase_01.png" id="fig-rsm-load-db-01" class="img-fluid" alt="Loading climate forcing into RS Minerve"> In the navigation window on the left, a data base icon will appear. Explore the Database by clicking on the triangle next to the icon. You can display the data in the data base by clicking on the Sensors (1), typically T, P and Q, in the navigation window. A time series plot will then appear in the main window. You can also explore the data in the table format by switching to the Values tab (2).</p>
<p><img src="images/hydrological_modeling/rsm_loadDatabase_012.png" id="fig-rsm-load-db-012" class="img-fluid" alt="Visualizing data base."> Note the time range of the forcing data (from Jan 1, 1979 0:00 to Dec.&nbsp;21, 2011 0:00). The time range of the forcing determines the time range of the simulation. Also note the time interval between the data (daily data for the forcing and decadal data for the discharge).</p>
<p>Click on <strong><em>New group</em></strong> (1, not visible because the name is already changed in <a href="#fig-rsm-load-db-02">Figure&nbsp;<span>8.17</span></a>) and change the name of the group to Climate (2). In the dropdown menu select Input for the data category (3).</p>
<div id="fig-rsm-load-db-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadDatabase_02.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.17: Loading climate forcing into RS Minerve</figcaption><p></p>
</figure>
</div>
<p>We now move the discharge time series to a separate data group: Select Database (1) then click Add (2). A new group appears at the bottom of the data list (3). Select New group (3) and change the name (4) to Discharge and select Input from the dropdown menu (5).</p>
<div id="fig-rsm-load-db-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadDatabase_03.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.18: Loading climate forcing into RS Minerve</figcaption><p></p>
</figure>
</div>
<p>Navigate to the discharge time series Q (1) and do a right-click. In the pop-up window that appears select Cut (2).</p>
<div id="fig-rsm-load-db-04" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadDatabase_04.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.19: Cut the discharge time series from the climate data group.</figcaption><p></p>
</figure>
</div>
<p>Select Discharge (1) and click Add (2) to add a new data set (3). Right-click on New Dataset and select Paste to put the discharge sensor data at the new location. You can rename New Dataset.</p>
<div id="fig-rsm-load-db-05" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadDatabase_05.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.20: Paste the discharge time series to the discharge data group.</figcaption><p></p>
</figure>
</div>
<p>The database is now ready, next we need to link the data to the model objects. Navigate to the Model tab. Under Data source select the appropriate data groups for the station data objects and for the source objects (1) and select the appropriate Dataset (2). The names in the database tab should already be consistent with the ones in the objects and the linking for the weather stations works automatically.</p>
<p><img src="images/hydrological_modeling/rsm_loadDatabase_06.png" id="fig-rsm-load-db-06" class="img-fluid" alt="Linking the database to the model objects and time configuration."> Then adapt the Start and End of the simulation period (4). Start cannot be earlier than the first forcing in the database and End cannot be later than the last forcing in the database. The simulation period can, however, be shorter than the forcing time series. The simulation time step is 1 day and the recording time step is 1 month (4).</p>
<p>The for the linking of the discharge data with the source we still need to double-click on the source object in the map (1) and select Q * Q in the drop-down menu (3).</p>
<div id="fig-rsm-load-db-07" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_loadDatabase_07.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.21: Linking the discharge with the source object</figcaption><p></p>
</figure>
</div>
</section><section id="configuration" class="level3" data-number="8.5.4"><h3 data-number="8.5.4" class="anchored" data-anchor-id="configuration">
<span class="header-section-number">8.5.4</span> Configuration</h3>
<p>Last but not least we need to tell RS Minerve to compute the evaporation flux for us. This step needs to be done only once for each model and is described in the <a href="@sec-quickguides-atapt-model-settings">Quick guide</a>. Don’t forget to save your model.</p>
</section><section id="sec-first-rsm-model-run" class="level3" data-number="8.5.5"><h3 data-number="8.5.5" class="anchored" data-anchor-id="sec-first-rsm-model-run">
<span class="header-section-number">8.5.5</span> First model run</h3>
<p>Now click Validation (1) to let RS Minerve test if the model is valid.</p>
<p><img src="images/hydrological_modeling/rsm_firstModelRun_01.png" id="fig-rsm-first-run-01" class="img-fluid" alt="Validation of the model."> In case the model is valid it will say so in the lower left corner of the RS Minerve window (2). A more detailed report appears in the output window on the right (3). The warning can be ignored as the discharge of the source is not a required input for the model simulation.</p>
<p>Now press Start (1). The simulation is done fairly quickly. With a double-click on the comparator object in the center window the output window fills with a lot of information. The Results table shows a number of indicators of model goodness. Here we will only briefly mention the most commonly encountered. Please read Chapter 3 on the performance indicators in the technical manual <span class="citation" data-cites="rsminerve_tm">(<a href="#ref-rsminerve_tm" role="doc-biblioref">Garcia Hernandez et al. 2020</a>)</span> for the equations of each available indicator.</p>
<p>The relative root mean squared error (RSME) ranges from 0 to <span class="math inline">\(\infty\)</span> and should be minimized.</p>
<p><span class="math display">\[
\text{RRMSE} = \frac{ \sqrt{ \frac{1}{N} \cdot \sum_{t=1}^N \Big( Q_{sim}(t) - Q_{obs}(t)\Big)^2}}{\overline{Q_{obs}(t)}}
\]</span></p>
<p>The Nash-Sutcliffe efficiency (Nash) ranges from -<span class="math inline">\(\infty\)</span> to 1 and should be maximized. Nash of 0 means that the model has the same performance as the average of the measured data.</p>
<p><span class="math display">\[
\text{Nash} = 1 − \frac{\sum_{t=1}^{N} \Big( Q_{sim}(t) - Q_{obs}(t) \Big)^2}{\sum_{t=1}^{N} \Big( Q_{sim}(t) - \overline{Q_{obs}(t)} \Big)^2}
\]</span></p>
<p>Where <span class="math inline">\(t\)</span> is the simulation time step, <span class="math inline">\(N\)</span> is the number of simulation time steps, <span class="math inline">\(Q_{sim}\)</span> is the simulated discharge and <span class="math inline">\(Q_{obs}\)</span> is the observed discharge. <span class="math inline">\(\overline{Q_{obs}}\)</span> refers to the average of the observed discharge.</p>
<p>If your customer is especially interested in low discharge periods, the Nash coefficient for logarithm values is recommended (see <span class="citation" data-cites="rsminerve_tm">Garcia Hernandez et al. (<a href="#ref-rsminerve_tm" role="doc-biblioref">2020</a>)</span>). There are further performance indicators focusing on the discharge volume (Relative Volume Bias) or on the exceedance of a threshold flow which can be specified in the parameters of the comparator.</p>
<div id="fig-rsm-first-run-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_firstModelRun_02.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.22: First model run.</figcaption><p></p>
</figure>
</div>
<p>The graph (4) shows the measured discharge in blue (QReference) and the simulated discharge in green (QSimulation).</p>
<p>Note that QSimulation starts with 0. This is because RS Minerve initializes the initial water content of the HBV modules with 0 unless something else is specified. You should click Conditions on Dec.&nbsp;12, 2011 (2), apply and re-run the model to obtain a properly initialized model.</p>
<p>To view the default initial conditions (IC) and parameters of a model object (2), double-click on the model object in the main model window (1). You can edit the IC and parameters in the tables of the result window (2). You can view properties of several objects the IC viewer (and similarly in the parameters viewer) by clicking on the Initial conditions button in the Model Properties toolbar (3). Select the object type (4) and the zone (5) and scroll through the IC table (6).</p>
<div id="fig-rsm-first-run-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_firstModelRun_03.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.23: Viewing initial model states and model parameters</figcaption><p></p>
</figure>
</div>
<p>It is recommended to save a backup of the initial parameter set. During model model calibration experiments the modeler can sometimes end up with unrealistic parameter combinations and then it is appropriate to reset the model and start afresh. Click on Export P in the Model Properties toolbar to save the default parameters as a text file which can be imported using the Import P button.</p>
<p>The model produces the correct seasonality but the water balance is way off. The RS Minerve model produces more discharge than is observed at the monitoring station. We fix this by calibrating the model. This is a big task and will be treated in the next chapter.</p>
</section></section><section id="sec-model-calibration" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="sec-model-calibration">
<span class="header-section-number">8.6</span> Model calibration</h2>
<p>The large number of parameters of the HBV model can be adjusted within reasonable ranges to make the simulated river discharge more similar to the measured discharge. This model calibration process is sometimes also called history matching because past or historical measurements are used to adapt the model parameters. Mathematically speaking, model calibration is an optimization problem where the value of a performance indicator (or a combination of several performance indicators) is minimized. An example: The model calibration changes the parameters of the model such that the error between the observed and simulated discharge is minimized.</p>
<p>The simplest form of such an equation is given below where for each time step <span class="math inline">\(t\)</span>, the difference between the simulated (<span class="math inline">\(Q_{sim}\)</span>) and observed (<span class="math inline">\(Q_{obs}\)</span>) discharge is computed. The simulated discharge depends on the parameters <span class="math inline">\(\boldsymbol{P}\)</span>. The differences between the simulated and observed discharge are summed up to result in one value <span class="math inline">\(\boldsymbol{E}\)</span>, depending on <span class="math inline">\(\boldsymbol{P}\)</span> which can be minimized by changing the parameters <span class="math inline">\(\boldsymbol{P}\)</span>.</p>
<p><span class="math display">\[
\min_{\boldsymbol{P}} \sum_{t=1}^{N} \Big( Q_{sim}(t, \boldsymbol{P}) - Q_{obs}(t)  \Big) = \min_{\boldsymbol{P}} \boldsymbol{E(\boldsymbol{P})}
\]</span></p>
<p>RS Minerve features implementations of several different performance indicators. The choice of the minimization function influences the calibration outcome. Two commonly used performance indicators are described [above]{<a href="#sec-first-rsm-model-run">Section&nbsp;<span>8.5.5</span></a>}. Please read the Chapter on the performance indicators of the RS Minerve technical manual <span class="citation" data-cites="rsminerve_tm">(<a href="#ref-rsminerve_tm" role="doc-biblioref">Garcia Hernandez et al. 2020</a>)</span> to also understand the other performance indicators.</p>
<p>Hydrological models are typically not well defined, i.e.&nbsp;multiple sets of parameter combinations will yield reasonable model performance. This property of hydrologial models is sometimes called the equifinality problem, i.e.&nbsp;several pathways lead to the same outcome. Modelers just have to live with this but there are several strategies to minimize the negative impact of the equifinality.</p>
<section id="calibration-and-validation" class="level4"><h4 class="anchored" data-anchor-id="calibration-and-validation">Calibration and validation</h4>
<p>An important strategy to gain confidence into a model is to split the simulation period into a calibration period and a validation period. During calibration, the model parameters are adjusted to get a satisfying fit with the measured discharge. During the validation period the calibrated model is compared to discharge data that the model hasn’t seen before, i.e.&nbsp;the model’s ability to handle potentially different model input than it has seen during calibration (also called its ability to generalize) is revealed. For example, 30 years of discharge time series can be split into the first 10 years for model calibration (i.e.&nbsp;model calibration is done only over the first 10 years of the time series) and into the last 20 years for model validation. A good model should perform satisfactorily not only during calibration but also during validation. If the model validation period shows better model performance than the calibration period, the modeler should take a close look at the forcing and try to explain this.</p>
<p>In hydrology, it is recommended to do cross-validation, i.e.&nbsp;to calibrate and validate a model with several combinations of calibration and validation periods and to summarize the overall model performance and the resulting parameter combinations.<br>
Interested readers are refered to the literature for a more thorough discussion of the topic. For example, Bergstroem <span class="citation" data-cites="bergstrom_principles_1991">(<a href="#ref-bergstrom_principles_1991" role="doc-biblioref">Bergström 1991</a>)</span> gives a thorough discussion of model calibration and validation based on the HBV model which is still valid today.</p>
</section><section id="warm-up-period" class="level4"><h4 class="anchored" data-anchor-id="warm-up-period">Warm-up period</h4>
<p>To overcome issues with the initial water content of the catchment, a warm-up or spin-up period is typically defined. For small basins with small storages (like the mountainous basins in Central Asia) one year of model warm up is typically sufficient to fill the models reservoir with an appropriate amount of water. The warm-up period is specified in the comparator properties and excluded from the automatic calibration process.</p>
<div id="fig-rsm-calibration-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_calibration_01.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.24: Set up a spin-up period which is excluded from the model calibration. Open the object properties with a double-click on the comparator object in the main model window (1) and specify a 1-year spin-up period in seconds (2).</figcaption><p></p>
</figure>
</div>
</section><section id="fixing-of-non-sensitive-parameters" class="level4"><h4 class="anchored" data-anchor-id="fixing-of-non-sensitive-parameters">Fixing of non-sensitive parameters</h4>
<p>Before starting a full automated calibration of the model, it is advisable to identify parameters which are not sensitive and to fix them to reasonable values. In a fist step, parameters of all HRUS in the catchments are assumed to be the same. Then, one by one, the parameters are varied (simultaneously in all HRUs) to assess the impact of the parameters on the resulting discharge. If one parameter value is not sensitive, i.e.&nbsp;if changing the parameter value does not significantly impact the discharge, it is fixed to a literature value. The following figures illustrate the procedure:</p>
<p><img src="images/hydrological_modeling/rsm_calibration_02.png" id="fig-rsm-calibration-02" class="img-fluid" alt="Simulation results of a non-calibrated hydrological model."> Remember the value of a performance indicator, for example the Nash efficiency. Then, open the Parameters window by pressing the Parameters button in the Model Properties toolbar (1), select HBV (2) and the default zone A (3) in the drop-down manus, and double the Melting factor (<span class="math inline">\(\text{CFMax}\)</span>) (4). Apply the changes (5) and re-run the model.</p>
<p><img src="images/hydrological_modeling/rsm_calibration_03.png" id="fig-rsm-calibration-03" class="img-fluid" alt="Manually changing parameter values to roughly assess parameter sensitivity."> If the performance indicator becomes worse (e.g.&nbsp;more negative in the case of Nash), change the parameter to half of the original parameter value (2.5 in the present example and re-run the model). In the Chon Kemin example shown here, Nash will become less negative. We conclude that <span class="math inline">\(\text{CFMax}\)</span> is a sensitive parameter that should be calibrated. If the change of the parameter value does not produce a similar relative change of the performance indicator, the model is not highly sensitive to that specific parameter and it does not need to be calibrated.</p>
</section><section id="cross-validation" class="level4"><h4 class="anchored" data-anchor-id="cross-validation">Cross-validation</h4>
<p>It is good practice to validate your results with data from the literature and with other, publicly available data sets. Literature values may be useful to limit parameter ranges for the calibration and to verify the conceptual hydrological model. Data sets like the High Mountain Asia Snow Reanalysis data set can be used to verify the snow water balance (automated calibration of snow water equivalents is not currently possible in RS Minerve) and for flatter areas, soil remotely sensed moisture observations and evaporation products may be used to constrain the parameters of the root zone and upper soil box.</p>
</section><section id="calibration-procedure" class="level4"><h4 class="anchored" data-anchor-id="calibration-procedure">Calibration procedure</h4>
<p>It is advisable to not calibrate all parameters at the same time but to calibrate module by module from the top-most layer to the bottom-most layer (along the flow path of the water). I.e. start by calibrating the sensitive parameters of the snow module, then proceed to the root zone module, the upper soil module and last calibrate the parameters of the groundwater module. This procedure may not yield an absolute minimum of the objective function (the best performance indicators possible) but it will leave you with physically meaningful parameters which is what is important.</p>
<p>In between calibrations of individual parameters, switch to the model tab or to the selection and plot tab and look at the results of individual model components. Make sure you don’t have accumulation of snow in the lower HRUs. Accumulation of snow is only allowed in glacierized HRUs. Also other water reservoirs may accidentally be filling up or emptying out, e.g.&nbsp;storage of the lower reservoir. Typically, the storage components in a hydrological system are more or less in steady-state (except for the glaciers). That means, that over several years, the water storage does not change much. If your model shows storage changes, they may be caused either by infrastructure or management changes (research) or by bad parameter sets. You should further update the initial conditions of the model from time to time to make sure that they are consistent with the model parameters.</p>
<p>You may perform several calibrations using different performance indicators and different calibration periods. This will give you a set of parameters which partially represent the uncertainty of the hydrological model.</p>
</section><section id="automatic-model-calibration-with-rs-minerve" class="level4"><h4 class="anchored" data-anchor-id="automatic-model-calibration-with-rs-minerve">Automatic model calibration with RS Minerve</h4>
<p>RS Minerve offers several interesting expert tools, including the Calibrator. Open the calibrator tab by clicking the Expert button in the Modules toolbar and select Calibrator. A calibrator tab will open up (<a href="#fig-rsm-calibration-04">Figure&nbsp;<span>8.25</span></a>). Follow the steps to set up your first calibration: Select the current calibration configuration (1). You may re-name it and save it (Export) for later use. Then select HBV (2) and Zone A (3) to tell the calibrator the objects that you want to calibrate parameters for. You also need to select the Comparator object based on which performance indicators will be computed (4). In the Parameters window, select one of your sensitive parameters and tick the box. Then you specify the performance indicator(s) that should be used in the calibration. You can combine several indicators with user defined weights, according to your preferences and needs. In this demo we use Nash with weight 1 (6) and Relative Volume Bias with weight 1 (7). Subsequently you specify the calibration period (8). Remember that you need to divide your modeling period in a calibration and a validation period. Once ready, press Start (9) and the calibrator starts spinning. You can monitor the progress of the calibration in the Summary results window (10) and in the Graphic results window (11).</p>
<div id="fig-rsm-calibration-04" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/hydrological_modeling/rsm_calibration_04.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8.25: Setting up a model calibration.</figcaption><p></p>
</figure>
</div>
<p>You proceed in the same way for all sensitive parameters and maybe re-calibrate some of the most sensitive ones. The best parameter sets are transferred to your model tab but make sure to save a copy of the calibrated parameters.</p>
</section></section><section id="sec-hydrological-hydraulic-modeling-references" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="sec-hydrological-hydraulic-modeling-references">
<span class="header-section-number">8.7</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-bergstrom_development_1976" class="csl-entry" role="doc-biblioentry">
Bergström, Sten. 1980. <span>“Development and Application of a Conceptual Runoff Model for <span>Scandinavian</span> Catchments.”</span> {SMHI} {Report} Nr Rho 7. Lund Institute of Technology/University of Lund.
</div>
<div id="ref-bergstrom_principles_1991" class="csl-entry" role="doc-biblioentry">
———. 1991. <span>“Principles and <span>Confidence</span> in <span>Hydrological</span> <span>Modelling</span>.”</span> <em>Hydrology Research</em> 22 (2): 123–36. <a href="https://doi.org/10.2166/nh.1991.0009">https://doi.org/10.2166/nh.1991.0009</a>.
</div>
<div id="ref-bloschl_scale_1995" class="csl-entry" role="doc-biblioentry">
Blöschl, G., and M. Sivapalan. 1995. <span>“Scale Issues in Hydrological Modelling: <span>A</span> Review.”</span> <em>Hydrological Processes</em> 9 (3-4): 251–90. https://doi.org/<a href="https://doi.org/10.1002/hyp.3360090305">https://doi.org/10.1002/hyp.3360090305</a>.
</div>
<div id="ref-rsminerve_software" class="csl-entry" role="doc-biblioentry">
CREALP. 2021. <em>RS MINERVE</em> (version 2.9.1.0). <a href="https://www.crealp.ch/fr/accueil/outils-services/logiciels/rs-minerve/telechargement-rsm.html">https://www.crealp.ch/fr/accueil/outils-services/logiciels/rs-minerve/telechargement-rsm.html</a>.
</div>
<div id="ref-rsminerve_um" class="csl-entry" role="doc-biblioentry">
Foehn, A., J. Garcia Hernandez, B. Roquier, J. Fluixa-Sanmartin, T. Brauchli, J. Paredes Arquiola, and G. De Cesare. 2020. <span>“RS MINERVE - User Manual, V2.15.”</span> ISSN 2673-2653. Switzerland: Ed. CREALP.
</div>
<div id="ref-rsminerve_tm" class="csl-entry" role="doc-biblioentry">
Garcia Hernandez, J., A. Foehn, J. Fluixa-Sanmartin, B. Roquier, T. Brauchli, J. Paredes Arquiola, and De Cesare G. 2020. <span>“RS MINERVE - Technical Manual, V2.25.”</span> ISSN 2673-2661. Switzerland: Ed. CREALP.
</div>
<div id="ref-lindstrom_development_1997" class="csl-entry" role="doc-biblioentry">
Lindström, Göran, Barbro Johansson, Magnus Persson, Marie Gardelin, and Sten Bergström. 1997. <span>“Development and Test of the Distributed <span>HBV</span>-96 Hydrological Model.”</span> <em>Journal of Hydrology</em> 201 (1-4): 272–88. <a href="https://doi.org/10.1016/S0022-1694(97)00041-3">https://doi.org/10.1016/S0022-1694(97)00041-3</a>.
</div>
<div id="ref-Pedersen1980" class="csl-entry" role="doc-biblioentry">
Pedersen, John T., John C. Peters, and Otto J. Helweg. 1980. <span>“Hydrographs by Single Linear Reservoir Model.”</span> {Technical Report} TP-74. US Army Corps of Engineers, Institute of Water Resources, Hydrologic Engineering Center.
</div>
<div id="ref-refsgaard_uncertainty_2007" class="csl-entry" role="doc-biblioentry">
Refsgaard, Jens Christian, Jeroen P. van der Sluijs, Anker Lajer Højberg, and Peter A. Vanrolleghem. 2007. <span>“Uncertainty in the Environmental Modelling Process – <span>A</span> Framework and Guidance.”</span> <em>Environmental Modelling &amp; Software</em> 22 (11): 1543–56. <a href="https://doi.org/10.1016/j.envsoft.2007.02.004">https://doi.org/10.1016/j.envsoft.2007.02.004</a>.
</div>
</div>
</section><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1" role="doc-endnote"><p>The reader is advised to consult the user manual and familiarizes themselves with the walk through examples that are discussed and presented there. They give a solid first hands-on introduction about the basic functionalities of the modeling environment.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./hydrological_modeling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part III: Hydrological Modeling &amp; Applications</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./long_term_water_balance_modeling.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Long-term Water Balance Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>